 #!/bin/bash
 
CONTRIB=$(mktemp)
FULLREPO=$1
if [ -z "$FULLREPO" ]
then
      echo "Usage $0 repo-url"
      exit 0
fi 

REPO=$(basename $FULLREPO) 
REPO="${REPO%.*}"
ORG=$(echo $FULLREPO | cut -d '/' -f 4) 
CONTRIB_FILENAME=CONTRIBUTING.md 
URL=https://raw.githubusercontent.com/$ORG/$REPO/main/$CONTRIB_FILENAME
DCO_TEXT="This project requires the Developer Certificate of Origin (DCO)"
curl -s $URL > $CONTRIB 
HAS_FILE=yes
HAS_DCO=no 
if cat "$CONTRIB" |  grep -q "404: Not Found"; then 
    HAS_FILE=no
else 
    if cat "$CONTRIB" | grep -q "$DCO_TEXT"; then
        HAS_DCO=yes 
    fi
fi  
printf "%40s: $CONTRIB_FILENAME: %4s DCO: %4s\n" $REPO $HAS_FILE $HAS_DCO
